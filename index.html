<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE GRIND | Finals Prep</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap');

        :root {
            --bg-color: #050505;
            --card-bg: #0a0a0a;
            
            /* Dynamic Theme Variables */
            --theme-color: #ffffff;
            --theme-glow: 0 0 10px rgba(255, 255, 255, 0.5), 0 0 20px rgba(255, 255, 255, 0.3);
            --theme-dim: rgba(255, 255, 255, 0.1);
        }

        body {
            background-color: var(--bg-color);
            color: var(--theme-color);
            font-family: 'Space Mono', monospace;
            overflow-x: hidden;
            transition: color 0.5s ease;
        }

        /* Neon Aesthetics */
        .neon-text {
            text-shadow: 0 0 5px var(--theme-color), 0 0 10px var(--theme-color);
        }

        .neon-border {
            border: 1px solid var(--theme-color);
            box-shadow: var(--theme-glow);
        }

        .neon-box {
            background: var(--card-bg);
            border: 1px solid #222;
            transition: all 0.3s ease;
            color: #ddd; /* Default text inside boxes for readability */
        }

        .neon-box h3, .neon-box .font-bold {
            color: var(--theme-color);
        }

        .neon-box:hover {
            border-color: var(--theme-color);
            box-shadow: var(--theme-glow);
            transform: translateY(-2px);
        }

        /* Flowy Animations */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0px); }
        }

        .float-anim {
            animation: float 4s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 5px var(--theme-color); opacity: 0.8; }
            50% { box-shadow: 0 0 20px var(--theme-color); opacity: 1; }
        }

        .pulse-anim {
            animation: pulse-glow 3s infinite;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #000;
        }
        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--theme-color);
        }

        /* Utilities */
        .hidden-section {
            display: none;
        }
        
        .checkbox-wrapper input:checked + div {
            background-color: var(--theme-color);
            color: black;
            box-shadow: 0 0 15px var(--theme-color);
        }
        
        .checkbox-wrapper input:checked + div h3,
        .checkbox-wrapper input:checked + div p,
        .checkbox-wrapper input:checked + div div {
            color: black;
            border-color: black;
        }

        .nav-item.active {
            border-bottom: 2px solid var(--theme-color);
            text-shadow: 0 0 10px var(--theme-color);
            color: var(--theme-color);
        }

        .nav-item:hover {
            background-color: var(--theme-dim);
            color: var(--theme-color);
        }

        /* Theme Selector Buttons */
        .theme-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #333;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .theme-btn:hover {
            transform: scale(1.1);
            border-color: white;
        }
        .theme-btn.selected {
            border-color: white;
            box-shadow: 0 0 15px currentColor;
        }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden">

    <!-- Header / Top Bar -->
    <header class="h-16 border-b border-gray-800 flex items-center justify-between px-6 bg-black z-50">
        <div class="flex items-center gap-3">
            <i class="fas fa-bolt text-2xl neon-text animate-pulse"></i>
            <h1 class="text-xl font-bold tracking-widest neon-text">THE GRIND</h1>
        </div>
        <div class="flex items-center gap-6">
            <div class="text-right hidden md:block">
                <div id="system-time" class="text-lg font-bold" style="color: var(--theme-color)">00:00:00 AM</div>
                <div id="system-date" class="text-xs text-gray-400">Loading...</div>
            </div>
            <div class="flex items-center gap-2 border px-3 py-1 rounded-sm transition-colors" style="border-color: var(--theme-color); box-shadow: var(--theme-glow)">
                <i class="fas fa-gem text-xs"></i>
                <span id="score-display" class="font-bold">0</span> PTS
            </div>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <!-- Sidebar Navigation -->
        <nav class="w-20 md:w-64 border-r border-gray-800 flex flex-col justify-between bg-black z-40">
            <div class="flex flex-col mt-4 gap-2">
                <button onclick="switchView('home')" class="nav-item active p-4 transition-colors text-left flex items-center gap-4">
                    <i class="fas fa-home text-xl w-6"></i> <span class="hidden md:inline">Dashboard</span>
                </button>
                <button onclick="switchView('calendar')" class="nav-item p-4 transition-colors text-left flex items-center gap-4">
                    <i class="fas fa-calendar-alt text-xl w-6"></i> <span class="hidden md:inline">Schedule</span>
                </button>
                <button onclick="switchView('classes')" class="nav-item p-4 transition-colors text-left flex items-center gap-4">
                    <i class="fas fa-book text-xl w-6"></i> <span class="hidden md:inline">Classes</span>
                </button>
                <button onclick="switchView('countdown')" class="nav-item p-4 transition-colors text-left flex items-center gap-4">
                    <i class="fas fa-hourglass-half text-xl w-6"></i> <span class="hidden md:inline">Countdown</span>
                </button>
                <button onclick="switchView('prep')" class="nav-item p-4 transition-colors text-left flex items-center gap-4">
                    <i class="fas fa-brain text-xl w-6"></i> <span class="hidden md:inline">Prep Strategy</span>
                </button>
                <button onclick="switchView('timer')" class="nav-item p-4 transition-colors text-left flex items-center gap-4">
                    <i class="fas fa-stopwatch text-xl w-6"></i> <span class="hidden md:inline">Focus Timer</span>
                </button>
                <button onclick="switchView('settings')" class="nav-item p-4 transition-colors text-left flex items-center gap-4 mt-4 border-t border-gray-800">
                    <i class="fas fa-cog text-xl w-6"></i> <span class="hidden md:inline">Settings</span>
                </button>
            </div>
            <div class="p-4 text-xs text-gray-500 hidden md:block text-center">
                NO PAIN NO GAIN
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="flex-1 overflow-y-auto p-4 md:p-8 relative">
            
            <!-- HOME DASHBOARD -->
            <section id="home-view" class="max-w-5xl mx-auto space-y-8">
                <!-- Quote -->
                <div class="neon-box p-6 rounded-sm text-center float-anim relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-full h-1 opacity-50" style="background-color: var(--theme-color)"></div>
                    <p id="daily-quote" class="text-lg md:text-2xl italic font-bold" style="color: var(--theme-color)">"Discipline is doing what needs to be done, even if you don't want to do it."</p>
                </div>

                <!-- Daily Grind -->
                <div>
                    <h2 class="text-2xl font-bold mb-4 border-b border-gray-800 pb-2 neon-text">TODAY'S GRIND</h2>
                    <div id="daily-tasks" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Immediate Upcoming -->
                <div>
                    <h2 class="text-2xl font-bold mb-4 border-b border-gray-800 pb-2 neon-text">UP NEXT</h2>
                    <div id="upcoming-preview" class="space-y-3">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </section>

            <!-- CALENDAR VIEW -->
            <section id="calendar-view" class="hidden-section max-w-5xl mx-auto">
                <h2 class="text-3xl font-bold mb-6 neon-text">MASTER SCHEDULE</h2>
                <div id="calendar-list" class="space-y-4">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- CLASSES VIEW -->
            <section id="classes-view" class="hidden-section max-w-5xl mx-auto">
                <h2 class="text-3xl font-bold mb-6 neon-text">SUBJECT SORT</h2>
                <div id="classes-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- COUNTDOWN VIEW -->
            <section id="countdown-view" class="hidden-section max-w-5xl mx-auto">
                <h2 class="text-3xl font-bold mb-6 neon-text">TIME REMAINING</h2>
                <div id="countdown-grid" class="grid grid-cols-1 gap-4">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- PREP STRATEGY VIEW -->
            <section id="prep-view" class="hidden-section max-w-5xl mx-auto">
                <h2 class="text-3xl font-bold mb-6 neon-text">TACTICAL PREP</h2>
                <p class="text-gray-400 mb-6">AI-Generated Strategy Guide for each assessment.</p>
                <div id="prep-list" class="space-y-8">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- TIMER VIEW -->
            <section id="timer-view" class="hidden-section h-full flex flex-col items-center justify-center">
                <div class="neon-box p-12 rounded-full w-80 h-80 flex flex-col items-center justify-center relative mb-8 pulse-anim" style="border-color: var(--theme-color)">
                    <div id="timer-display" class="text-6xl font-bold tracking-tighter" style="color: var(--theme-color)">25:00</div>
                    <div id="timer-status" class="text-sm mt-2 text-gray-400">FOCUS</div>
                </div>
                
                <div class="flex gap-4 mb-8">
                    <button onclick="setTimer(25)" class="border border-gray-600 px-4 py-2 hover:bg-white hover:text-black transition-colors">Pomodoro (25)</button>
                    <button onclick="setTimer(5)" class="border border-gray-600 px-4 py-2 hover:bg-white hover:text-black transition-colors">Break (5)</button>
                    <button onclick="setTimer(50)" class="border border-gray-600 px-4 py-2 hover:bg-white hover:text-black transition-colors">Deep Work (50)</button>
                </div>

                <div class="flex gap-4">
                    <button onclick="toggleTimer()" id="start-btn" class="bg-white text-black px-8 py-3 font-bold transition-shadow" style="background-color: var(--theme-color)">START</button>
                    <button onclick="resetTimer()" class="border px-8 py-3 font-bold hover:bg-gray-900" style="border-color: var(--theme-color); color: var(--theme-color)">RESET</button>
                </div>
            </section>

            <!-- SETTINGS VIEW -->
            <section id="settings-view" class="hidden-section max-w-5xl mx-auto">
                <h2 class="text-3xl font-bold mb-6 neon-text">SYSTEM SETTINGS</h2>
                
                <div class="neon-box p-8">
                    <h3 class="text-xl font-bold mb-6">INTERFACE THEME</h3>
                    <div class="grid grid-cols-4 md:grid-cols-8 gap-6 justify-items-center">
                        <!-- Theme Buttons -->
                        <div onclick="setTheme('#ffffff')" class="theme-btn" style="background-color: #ffffff; color: #ffffff" title="Ghost"></div>
                        <div onclick="setTheme('#ef4444')" class="theme-btn" style="background-color: #ef4444; color: #ef4444" title="Crimson"></div>
                        <div onclick="setTheme('#3b82f6')" class="theme-btn" style="background-color: #3b82f6; color: #3b82f6" title="Tron"></div>
                        <div onclick="setTheme('#22c55e')" class="theme-btn" style="background-color: #22c55e; color: #22c55e" title="Matrix"></div>
                        <div onclick="setTheme('#a855f7')" class="theme-btn" style="background-color: #a855f7; color: #a855f7" title="Cyberpunk"></div>
                        <div onclick="setTheme('#f97316')" class="theme-btn" style="background-color: #f97316; color: #f97316" title="Hazard"></div>
                        <div onclick="setTheme('#ec4899')" class="theme-btn" style="background-color: #ec4899; color: #ec4899" title="Vaporwave"></div>
                        <div onclick="setTheme('#eab308')" class="theme-btn" style="background-color: #eab308; color: #eab308" title="Midas"></div>
                    </div>
                    <p class="text-center mt-6 text-sm text-gray-500">Select a core color to update the neural interface.</p>
                </div>

                <div class="neon-box p-8 mt-6 opacity-50 cursor-not-allowed">
                    <h3 class="text-xl font-bold mb-2">DATA MANAGEMENT</h3>
                    <p class="text-sm text-gray-500 mb-4">Export schedule or reset points (Coming Soon)</p>
                    <button class="border border-gray-600 text-gray-600 px-4 py-2 text-sm">RESET ALL DATA</button>
                </div>
            </section>

        </main>
    </div>

    <script>
        // --- DATA ---
        const schedule = [
            { date: "2025-11-25", title: "Speaking Quiz 4", class: "Romanian", type: "Quiz", weight: 3 },
            { date: "2025-12-01", title: "Campus Orchestra Concert", class: "Music", type: "Event", weight: 1 },
            { date: "2025-12-02", title: "Prep Check 9", class: "Romanian", type: "Quiz", weight: 2 },
            { date: "2025-12-02", title: "Quiz 8", class: "Organic Chemistry", type: "Quiz", weight: 3 },
            { date: "2025-12-03", title: "Listening Quiz", class: "Romanian", type: "Quiz", weight: 3 },
            { date: "2025-12-07", title: "Assessment Ch 15/16", class: "Psych 3313", type: "Test", weight: 4 },
            { date: "2025-12-07", title: "Quiz Ch 16", class: "Psych 3313", type: "Quiz", weight: 2 },
            { date: "2025-12-08", title: "Assignment 3", class: "Psych 3513", type: "Assignment", weight: 3 },
            { date: "2025-12-09", title: "Oral Exam", class: "Romanian", type: "Exam", weight: 5 },
            { date: "2025-12-10", title: "Exam 3", class: "Psych 3513", type: "Exam", weight: 5 },
            { date: "2025-12-11", title: "HW - CV", class: "Neuro Survey", type: "Assignment", weight: 2 },
            { date: "2025-12-12", title: "Final Exam", class: "Romanian", type: "Final", weight: 10 },
            { date: "2025-12-12", title: "Final Exam", class: "Statistics", type: "Final", weight: 10 },
            { date: "2025-12-15", title: "Final Exam", class: "Organic Chemistry", type: "Final", weight: 10 },
            { date: "2025-12-15", title: "Final Exam Online", class: "Psych 3513", type: "Final", weight: 10 },
            { date: "2025-12-18", title: "Final Exam Online", class: "Psych 3313", type: "Final", weight: 10 },
        ];

        const quotes = [
            "We suffer more often in imagination than in reality.",
            "The pain of discipline is far less than the pain of regret.",
            "Your future self is watching you right now through memories.",
            "Don't stop when you're tired. Stop when you're done.",
            "Grind in silence. Let success make the noise.",
            "It's you vs. you."
        ];

        const prepStrategies = {
            "Quiz": [
                "Review lecture notes from the last 3 sessions.",
                "Create flashcards for key terms.",
                "Do 10 practice problems.",
                "Simulate the quiz environment (timer on)."
            ],
            "Test": [
                "Summarize chapters into 1-page cheat sheets.",
                "Teach the concepts to an imaginary audience.",
                "Review past quiz mistakes.",
                "Focus on the 'why', not just the 'what'."
            ],
            "Exam": [
                "Full comprehensive review of all units.",
                "Take a full-length practice exam.",
                "Sleep 8 hours the night before.",
                "Identify weak spots and drill them specifically."
            ],
            "Final": [
                "THE BIG ONE. Synthesize all semester notes.",
                "Look for recurring themes across the course.",
                "Practice cumulative problem sets.",
                "Manage stress: hydration and breaks are study tools."
            ],
            "Assignment": [
                "Break the task into 3 small chunks.",
                "Draft an outline before writing.",
                "Review the rubric twice.",
                "Proofread after a 1-hour break."
            ],
            "Event": [
                "Prepare your attire/equipment the night before.",
                "Visualize a successful performance.",
                "Arrive 15 minutes early."
            ]
        };

        // --- STATE ---
        let points = parseInt(localStorage.getItem('grindPoints')) || 0;
        let completedTasks = JSON.parse(localStorage.getItem('completedTasks')) || [];
        let currentTheme = localStorage.getItem('grindTheme') || '#ffffff';
        let timerInterval;
        let timeLeft = 25 * 60;
        let isTimerRunning = false;

        // --- INIT ---
        window.onload = function() {
            setTheme(currentTheme);
            updateSystemTime();
            setInterval(updateSystemTime, 1000); // Clock update
            
            renderHome();
            renderCalendar();
            renderClasses();
            renderCountdown();
            renderPrep();
            updatePointsDisplay();
            
            // Random Quote
            document.getElementById('daily-quote').innerText = `"${quotes[Math.floor(Math.random() * quotes.length)]}"`;
            
            // Countdown Updater
            setInterval(renderCountdown, 60000); // Update minutes every minute
        };

        // --- THEME ENGINE ---
        function setTheme(color) {
            currentTheme = color;
            localStorage.setItem('grindTheme', color);
            
            const root = document.documentElement;
            root.style.setProperty('--theme-color', color);
            root.style.setProperty('--theme-glow', `0 0 10px ${color}80, 0 0 20px ${color}4d`); // 80 is approx 50% opacity in hex, 4d is 30%
            root.style.setProperty('--theme-dim', `${color}1a`); // 1a is approx 10% opacity
            
            // Update selected button state
            document.querySelectorAll('.theme-btn').forEach(btn => {
                if(btn.getAttribute('onclick').includes(color)) {
                    btn.classList.add('selected');
                } else {
                    btn.classList.remove('selected');
                }
            });
        }

        // --- NAVIGATION ---
        function switchView(viewName) {
            document.querySelectorAll('section').forEach(el => el.classList.add('hidden-section'));
            document.getElementById(`${viewName}-view`).classList.remove('hidden-section');
            
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }

        // --- RENDERERS ---

        function renderHome() {
            const today = new Date();
            today.setHours(0,0,0,0);
            
            const taskContainer = document.getElementById('daily-tasks');
            taskContainer.innerHTML = '';

            const upNextContainer = document.getElementById('upcoming-preview');
            upNextContainer.innerHTML = '';

            // Find immediate upcoming (next 3)
            const upcoming = schedule.filter(item => new Date(item.date) >= today).sort((a, b) => new Date(a.date) - new Date(b.date));
            
            // Daily Tasks (Logic: If event is today, task is "Perform". If event is within 3 days, task is "Study")
            let dailyGrindCount = 0;

            upcoming.slice(0, 4).forEach((item, index) => {
                const itemDate = new Date(item.date);
                const diffTime = Math.ceil((itemDate - today) / (1000 * 60 * 60 * 24));
                
                let taskText = "";
                let pointsVal = 50;

                if (diffTime === 0) {
                    taskText = `EXECUTE: ${item.title}`;
                    pointsVal = 100;
                } else if (diffTime <= 2) {
                    taskText = `CRAM/REVIEW: ${item.title}`;
                } else {
                    taskText = `PREP MATERIAL: ${item.title}`;
                }

                const taskId = `task-${item.date}-${item.title.replace(/\s/g, '')}`;
                const isChecked = completedTasks.includes(taskId) ? 'checked' : '';

                const html = `
                    <label class="checkbox-wrapper cursor-pointer group block">
                        <input type="checkbox" class="hidden" ${isChecked} onchange="toggleTask('${taskId}', ${pointsVal})">
                        <div class="neon-box p-4 flex items-center justify-between group-hover:bg-gray-900 transition-colors">
                            <div>
                                <h3 class="font-bold text-sm text-gray-400" style="color: var(--theme-color)">${item.class}</h3>
                                <p class="text-lg text-gray-200">${taskText}</p>
                            </div>
                            <div class="text-xs border px-2 py-1 rounded" style="border-color: var(--theme-color); color: var(--theme-color)">+${pointsVal} PTS</div>
                        </div>
                    </label>
                `;
                taskContainer.innerHTML += html;
                dailyGrindCount++;
            });

            // Up Next List
            upcoming.slice(0, 5).forEach(item => {
                const d = new Date(item.date);
                const dateStr = d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                const html = `
                    <div class="flex justify-between items-center border-b border-gray-800 pb-2">
                        <div>
                            <span class="text-xs text-gray-500 block">${dateStr}</span>
                            <span class="font-bold text-gray-300">${item.title}</span>
                        </div>
                        <span class="text-xs bg-gray-800 text-white px-2 py-1 font-bold">${item.class}</span>
                    </div>
                `;
                upNextContainer.innerHTML += html;
            });
        }

        function renderCalendar() {
            const container = document.getElementById('calendar-list');
            container.innerHTML = '';
            
            schedule.forEach(item => {
                const d = new Date(item.date);
                const dateStr = d.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
                
                const html = `
                    <div class="neon-box p-4 flex flex-col md:flex-row md:items-center justify-between gap-4">
                        <div class="flex items-center gap-4">
                            <div class="text-center w-16 border-r border-gray-700 pr-4">
                                <div class="text-sm text-gray-400">${d.toLocaleString('default', { month: 'short' })}</div>
                                <div class="text-2xl font-bold text-gray-200">${d.getDate()}</div>
                            </div>
                            <div>
                                <div class="text-xl font-bold" style="color: var(--theme-color)">${item.title}</div>
                                <div class="text-sm text-gray-400">${item.class}</div>
                            </div>
                        </div>
                        <div class="flex items-center gap-2">
                             <span class="text-xs border border-gray-600 px-2 py-1 text-gray-400">${item.type.toUpperCase()}</span>
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        function renderClasses() {
            const container = document.getElementById('classes-grid');
            container.innerHTML = '';
            
            // Group by class
            const groups = schedule.reduce((acc, item) => {
                (acc[item.class] = acc[item.class] || []).push(item);
                return acc;
            }, {});

            Object.keys(groups).forEach(className => {
                let itemsHtml = '';
                groups[className].forEach(item => {
                     const d = new Date(item.date);
                     itemsHtml += `
                        <li class="flex justify-between text-sm py-1 border-b border-gray-800 border-dashed">
                            <span class="text-gray-300">${item.title}</span>
                            <span class="text-gray-500">${d.getDate()} ${d.toLocaleString('default', { month: 'short' })}</span>
                        </li>
                     `;
                });

                const html = `
                    <div class="neon-box p-6 relative overflow-hidden">
                        <div class="absolute -right-4 -top-4 text-8xl opacity-10 font-bold select-none" style="color: var(--theme-color)">${className.charAt(0)}</div>
                        <h3 class="text-xl font-bold mb-4 border-b-2 inline-block pb-1" style="border-color: var(--theme-color); color: var(--theme-color)">${className}</h3>
                        <ul class="space-y-2 relative z-10">
                            ${itemsHtml}
                        </ul>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        function renderCountdown() {
            const container = document.getElementById('countdown-grid');
            container.innerHTML = '';
            
            const now = new Date();

            schedule.filter(i => new Date(i.date) > now).forEach(item => {
                const target = new Date(item.date);
                target.setHours(9, 0, 0); // Assume 9 AM start
                
                const diff = target - now;
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                
                let urgencyClass = "text-gray-400";
                if(days < 2) urgencyClass = "text-red-500 animate-pulse";
                else if(days < 5) urgencyClass = "text-yellow-500";
                else urgencyClass = "text-gray-200";

                const html = `
                    <div class="flex items-center justify-between bg-gray-900 p-4 border-l-4" style="border-color: ${days < 2 ? '#ef4444' : 'var(--theme-color)'}">
                        <div>
                            <div class="font-bold text-lg" style="color: var(--theme-color)">${item.title}</div>
                            <div class="text-xs text-gray-500">${item.class}</div>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-mono ${urgencyClass}">${days}d ${hours}h</div>
                            <div class="text-xs text-gray-600">REMAINING</div>
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        function renderPrep() {
            const container = document.getElementById('prep-list');
            container.innerHTML = '';

            schedule.forEach(item => {
                const strategies = prepStrategies[item.type] || prepStrategies["Quiz"];
                const stratList = strategies.map(s => `<li><i class="fas fa-check text-xs mr-2" style="color: var(--theme-color)"></i>${s}</li>`).join('');

                const html = `
                    <div class="border-l-2 pl-4 py-2 hover:bg-gray-900 transition-colors" style="border-color: var(--theme-color)">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-bold text-lg" style="color: var(--theme-color)">${item.title} <span class="text-sm font-normal text-gray-500">(${item.class})</span></h3>
                            <span class="text-xs bg-gray-800 px-2 py-1 text-gray-400">${item.type}</span>
                        </div>
                        <ul class="text-sm text-gray-300 space-y-1">
                            ${stratList}
                        </ul>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        // --- UTILS ---

        function updateSystemTime() {
            const now = new Date();
            // Changed to 12-hour format with seconds included
            document.getElementById('system-time').innerText = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', second: '2-digit', hour12: true });
            document.getElementById('system-date').innerText = now.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        }

        function toggleTask(taskId, pointVal) {
            const checkbox = event.target;
            if (checkbox.checked) {
                if (!completedTasks.includes(taskId)) {
                    completedTasks.push(taskId);
                    points += pointVal;
                }
            } else {
                if (completedTasks.includes(taskId)) {
                    completedTasks = completedTasks.filter(t => t !== taskId);
                    points -= pointVal;
                }
            }
            
            localStorage.setItem('grindPoints', points);
            localStorage.setItem('completedTasks', JSON.stringify(completedTasks));
            updatePointsDisplay();
        }

        function updatePointsDisplay() {
            document.getElementById('score-display').innerText = points;
        }

        // --- TIMER LOGIC ---

        function setTimer(minutes) {
            stopTimer();
            timeLeft = minutes * 60;
            updateTimerDisplay();
            document.getElementById('timer-status').innerText = minutes === 5 ? "RECHARGE" : "GRIND MODE";
        }

        function updateTimerDisplay() {
            const m = Math.floor(timeLeft / 60);
            const s = timeLeft % 60;
            document.getElementById('timer-display').innerText = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }

        function toggleTimer() {
            if (isTimerRunning) {
                stopTimer();
            } else {
                startTimer();
            }
        }

        function startTimer() {
            if (isTimerRunning) return;
            isTimerRunning = true;
            document.getElementById('start-btn').innerText = "PAUSE";
            timerInterval = setInterval(() => {
                if (timeLeft > 0) {
                    timeLeft--;
                    updateTimerDisplay();
                } else {
                    stopTimer();
                    alert("Grind Session Complete.");
                    points += 20; // Bonus for completing timer
                    updatePointsDisplay();
                    localStorage.setItem('grindPoints', points);
                }
            }, 1000);
        }

        function stopTimer() {
            isTimerRunning = false;
            clearInterval(timerInterval);
            document.getElementById('start-btn').innerText = "START";
        }

        function resetTimer() {
            stopTimer();
            timeLeft = 25 * 60;
            updateTimerDisplay();
        }

    </script>
</body>
</html>
